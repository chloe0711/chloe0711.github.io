<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Shantell+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <meta charset="UTF-8" />
  <title>What kind of netizen are you?</title>
  <style>
    .shantell-sans {
      font-family: "Shantell Sans", cursive;
      font-optical-sizing: auto;
    }

    .start-btn {
      margin-top: auto;
      margin-bottom: 12vh;
      padding: 20px 40px;
      cursor: pointer;
      transition: transform 0.2s ease;
      width: 200px;
    }

    .start-btn:hover {
      transform: scale(1.05);
    }
  
    html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    font-family: 'Shantell Sans', sans-serif;
    background: #FAEB92;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

    form {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .step {
      display: none;
      flex-direction: column;
      align-items: center;
      text-align: center;
      width: 100%;
      margin-top: -100px;
    }

    .step.active {
      display: flex;
    }

    .question {
      font-size: 1.6rem;
      margin-bottom: 100px;
      margin-left: 50px;
      margin-right: 50px;
      font-family: 'Shantell Sans', sans-serif;
    }

    .grid-options {
      display: grid;
      grid-template-columns: repeat(2, 400px);
      gap: 20px 20px;
      justify-content: center;

      position: fixed;
      bottom: 100px;
      width: 100%;
      padding: 0 40px;
      box-sizing: border-box;
      z-index: 10;
    }

    input[type="radio"] {
      display: none;
    }

    .btn-option {
      background-color: #CC66DA;
      color: black;
      border: none;
      border-radius: 10px;
      padding: 20px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.2s ease;
      white-space: normal;
      display: flex;
      justify-content: center;
      align-items: center;
      line-height: 1.4;
      font-family: 'Shantell Sans', sans-serif;
    }

    .btn-option:hover {
      background-color: #9929EA;
    }

    input[type="radio"]:checked + .btn-option {
      background-color: #8A2BE2;
    }

    .buttons {
      position: fixed;
      bottom: 30px;
      width: 100%;
      padding: 0 40px;
      display: flex;
      justify-content: space-between;
      box-sizing: border-box;
      z-index: 10;
      background: transparent;
    }

    button {
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .step {
        padding-top: 40px;
        }
    }

    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 6px;
      background-color: rgba(255, 255, 255, 0.2);
      z-index: 100;
    }

    #progressBar {
      height: 100%;
      width: 0%;
      background-color: #F72798;
      transition: width 0.3s ease;
    }

    .nav-btn {
      height: 50px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .nav-btn:hover {
      transform: scale(1.05);
    }

    #homePage {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 960px;
      height: 540px;
      background: url('start.png') no-repeat center center;
      background-size: cover;
    }

    section {
      height: 100vh;
      width: 100%;
      justify-content: center;
      align-items: center;
      display: none;
      flex-direction: column;
    }

    .fade-loop {
      animation: fadeInOut 3s ease-in-out infinite;
      width: 200px; /* or whatever fits */
    }

    @keyframes fadeInOut {
      0%, 100% {
      opacity: 0;
    }
      50% {
      opacity: 1;
    }
    }

  </style>
  <audio id="clickSound" src="click.mp3" preload="auto"></audio>
  <audio id="startSound" src="start.mp3"></audio>
  <audio id="bgm" src="bgm.mp3" loop></audio>
  <div style="display: none;">
    <img src="main-a.gif">
    <img src="main-b.gif">
    <img src="main-c.gif">
    <img src="main-d.gif">
    <img src="q0a1.gif">
    <img src="q0a2.gif">
    <img src="q0a3.gif" class="fade-loop" alt="Looping gif" />
    <img src="q0a4.gif">
    <img src="q1a1.gif">
    <img src="q1a2.gif">
    <img src="q1a3.gif">
    <img src="q1a4.gif">
    <img src="q2a1.gif">
    <img src="q2a2.gif">
    <img src="q2a3.gif">
    <img src="q2a4.gif">
    <img src="q3a1.gif">
    <img src="q3a2.gif">
    <img src="q3a3.gif">
    <img src="q3a4.gif">
    <img src="q4a1.gif">
    <img src="q4a2.gif">
    <img src="q4a3.gif">
    <img src="q4a4.gif">
  </div>
</head>
<body>
  <section id="homePage">
    <img src="start.gif" class="start-btn" onclick="startQuiz()"/>
  </section>

<section id="quizPage">
  <div class="progress-bar">
    <div id="progressBar"></div>
  </div>

  <form id="quizForm">
    <div id="stepContainer">
    <div class="step active" data-step="0">
      <div class="question">You're turning 18 and your 25 year old online friend suddenly asks for explicit images.<br><u>What do you do?</u></div>
      <div class="grid-options">
        <input type="radio" id="q0a1" name="q0" value="a"><label class="btn-option" for="q0a1">Agree, because why not?</label>
        <input type="radio" id="q0a2" name="q0" value="b"><label class="btn-option" for="q0a2">Say no and continue the conversation.</label>
        <input type="radio" id="q0a3" name="q0" value="c"><label class="btn-option" for="q0a3">Ghost them.</label>
        <input type="radio" id="q0a4" name="q0" value="d"><label class="btn-option" for="q0a4">Block and report!</label>
      </div>
    </div>

    <div class="step" data-step="1">
      <div class="question">You get an email from police@gmail.com about you receiving a fine, requesting that you click a link to pay ASAP or face charges.<br><u>What do you do?</u></div>
      <div class="grid-options">
        <input type="radio" id="q1a1" name="q1" value="a"><label class="btn-option" for="q1a1">Click the link and pay immediately!</label>
        <input type="radio" id="q1a2" name="q1" value="b"><label class="btn-option" for="q1a2">Click the link cautiously, not paying yet.</label>
        <input type="radio" id="q1a3" name="q1" value="c"><label class="btn-option" for="q1a3">Don't click the link and try to find more information first.</label>
        <input type="radio" id="q1a4" name="q1" value="d"><label class="btn-option" for="q1a4">Don't click the link and report it!</label>
      </div>
    </div>

    <div class="step" data-step="2">
      <div class="question">You're livestreaming from your room and viewers want a room tour.<br><u>What do you do?</u></div>
      <div class="grid-options">
        <input type="radio" id="q2a1" name="q2" value="a"><label class="btn-option" for="q2a1">Full room tour! Show them the great view from your window!</label>
        <input type="radio" id="q2a2" name="q2" value="b"><label class="btn-option" for="q2a2">Do it cautiously, trying to avoid the camera catching anything that could dox you.</label>
        <input type="radio" id="q2a3" name="q2" value="c"><label class="btn-option" for="q2a3">Do it without thought.</label>
        <input type="radio" id="q2a4" name="q2" value="d"><label class="btn-option" for="q2a4">Tell them I don't want to.</label>
      </div>
    </div>

    <div class="step" data-step="3">
      <div class="question">You need to create a new account to use a website.<br><u>What do you do?</u></div>
      <div class="grid-options">
        <input type="radio" id="q3a1" name="q3" value="a"><label class="btn-option" for="q3a1">Use my birthday as my password.</label>
        <input type="radio" id="q3a2" name="q3" value="b"><label class="btn-option" for="q3a2">Use password generated by web browser.</label>
        <input type="radio" id="q3a3" name="q3" value="c"><label class="btn-option" for="q3a3">Use a strong password (>7 characters & 1 special character, with a mix of cases.)</label>
        <input type="radio" id="q3a4" name="q3" value="d"><label class="btn-option" for="q3a4">Use strong password and set up 2-factor authorization.</label>
      </div>
    </div>

    <div class="step" data-step="4">
      <div class="question">Someone leaves a mean comment on your post and many others agree with them.<br><u>What do you do?</u></div>
      <div class="grid-options">
        <input type="radio" id="q4a1" name="q4" value="a"><label class="btn-option" for="q4a1">Cry.</label>
        <input type="radio" id="q4a2" name="q4" value="b"><label class="btn-option" for="q4a2">Report them.</label>
        <input type="radio" id="q4a3" name="q4" value="c"><label class="btn-option" for="q4a3">Argue back!</label>
        <input type="radio" id="q4a4" name="q4" value="d"><label class="btn-option" for="q4a4">Block and ignore them.</label>
      </div>
    </div>
    </div>

    <!--navi-->
    <div class="buttons">
      <img src="back.gif" id="backBtn" class="nav-btn" alt="Back"/>
      <img src="next.gif" id="nextBtn" class="nav-btn" alt="Next"/>
    </div>
  </form>
 </section>

  <script>
    // sounds
    showStep(currentStep);
    window.addEventListener("mousedown", function (e) {
  if (e.button === 0) {
    const clickSound = document.getElementById("clickSound");
    if (clickSound) {
      clickSound.currentTime = 0;
      clickSound.play().catch(() => {});
    }
  }
});

    document.getElementById('homePage').style.display = 'flex';

    let bgmHasStarted = false;
    const clickSound = document.getElementById("clickSound");
    clickSound.volume = 0.2;
    
  function startQuiz() {
  document.getElementById('homePage').style.display = 'none';
  document.getElementById('quizPage').style.display = 'block';

  const clickSound = document.getElementById("clickSound");
  clickSound.volume = 0.2;
  clickSound.play().catch(() => {});

  const startSound = document.getElementById("startSound");
  const bgm = document.getElementById("bgm");

  startSound.volume = 0.4;
  startSound.play();

  startSound.addEventListener("ended", () => {
    if (!bgmHasStarted) {
      bgm.volume = 0.6;
      bgm.play();
      bgmHasStarted = true;
    } else {
      bgm.play();
    }
  });
  }


    // everything else
    shuffleSteps();
      function shuffleElements(container) {
      const children = Array.from(container.children);
      const pairs = [];
      for (let i = 0; i < children.length; i += 2) {
      pairs.push([children[i], children[i + 1]]);
    }

      for (let i = pairs.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [pairs[i], pairs[j]] = [pairs[j], pairs[i]];
    }

      container.innerHTML = '';
      pairs.forEach(([input, label]) => {
      container.appendChild(input);
      container.appendChild(label);
      });
    }

    const steps = document.querySelectorAll('.step');
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    let currentStep = 0;

    function showStep(index) {
      steps.forEach((step, i) => {
        step.classList.toggle('active', i === index);
      });
      backBtn.disabled = index === 0;
      backBtn.style.opacity = index === 0 ? '0.4' : '1';
      backBtn.style.pointerEvents = index === 0 ? 'none' : 'auto';
      nextBtn.textContent = index === steps.length - 1 ? "Finish" : "Next";
       const progress = ((index + 1) / steps.length) * 100;
      document.getElementById("progressBar").style.width = progress + "%";
    }

    nextBtn.addEventListener('click', () => {
      const currentInputs = steps[currentStep].querySelectorAll('input[type="radio"]');
      const answered = Array.from(currentInputs).some(input => input.checked);
      if (!answered) {
        alert("Please choose an option!");
        return;
      }

      if (currentStep < steps.length - 1) {
        currentStep++;
        showStep(currentStep);
      } else {
       calculateResult();
      }
    });

    backBtn.addEventListener('click', () => {
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    });

  document.querySelectorAll('.grid-options').forEach(shuffleElements);

    function shuffleSteps() {
  const container = document.getElementById("stepContainer");
  const stepsArray = Array.from(container.children);

  for (let i = stepsArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [stepsArray[i], stepsArray[j]] = [stepsArray[j], stepsArray[i]];
  }

  stepsArray.forEach((step, idx) => {
    // Update data-step and radio names
    step.setAttribute("data-step", idx);
    const radios = step.querySelectorAll('input[type="radio"]');
    radios.forEach((radio, i) => {
      const newName = `q${idx}`;
      const newId = `q${idx}a${i + 1}`;
      const label = step.querySelector(`label[for="${radio.id}"]`);
      radio.name = newName;
      radio.id = newId;
      label.setAttribute("for", newId);
    });
    container.appendChild(step);
    });
  }

    showStep(currentStep);
 function calculateResult() {
  // Gather answers first
  const answers = [];
  const scores = { a: 0, b: 0, c: 0, d: 0 };

  for (let i = 0; i < steps.length; i++) {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    if (selected) {
      answers.push(selected.value);
      scores[selected.value]++;
    }
  }

  // Get final result type
  const resultType = Object.keys(scores).reduce((a, b) =>
    scores[a] > scores[b] ? a : b
  );

  // Hide quiz
  document.getElementById('quizForm').style.display = 'none';
  document.getElementById('progressBar').style.display = 'none';

  // Set up result container
  const resultContainer = document.createElement("div");
  resultContainer.style.position = "relative";
  resultContainer.style.width = "960px";
  resultContainer.style.height = "540px";
  resultContainer.style.margin = "0 auto";
  resultContainer.style.overflow = "hidden";

  // Create main result image
  const mainResult = document.createElement("img");
  mainResult.src = `main-${resultType}.gif`;
  mainResult.style.width = "300px";
  mainResult.style.position = "absolute";
  mainResult.style.left = "50%";
  mainResult.style.top = "50%";
  mainResult.style.transform = "translate(-50%, -50%)";
  resultContainer.appendChild(mainResult);

  // Predefined positions
  const positions = [
    { top: "5%", left: "50%", transform: "translate(-50%, 0)" },
    { top: "5%", left: "5%", transform: "translate(0, 0)" },
    { top: "5%", left: "95%", transform: "translate(-100%, 0)" },
    { top: "95%", left: "5%", transform: "translate(0, -100%)" },
    { top: "95%", left: "95%", transform: "translate(-100%, -100%)" }
  ];

  // Add the five small result icons
  for (let i = 0; i < answers.length; i++) {
    const img = document.createElement("img");
    img.src = `q${i}${answers[i]}.gif`;
    img.style.position = "absolute";
    img.style.width = "100px";
    img.style.top = positions[i].top;
    img.style.left = positions[i].left;
    img.style.transform = positions[i].transform;
    resultContainer.appendChild(img);
  }

  // Credit bar
  const creditBar = document.createElement("div");
  creditBar.textContent = "quiz & illust: chloe hor; music: mp3 by lucy, cover by @요-h7z on youtube; sfx: pixabay";
  creditBar.style.position = "absolute";
  creditBar.style.bottom = "10px";
  creditBar.style.width = "100%";
  creditBar.style.textAlign = "center";
  creditBar.style.fontSize = "14px";
  creditBar.style.color = "black";
  creditBar.style.fontFamily = "'Shantell Sans', sans-serif";
  resultContainer.appendChild(creditBar);

  document.body.appendChild(resultContainer);
}
  </script>
</body>
</html>
